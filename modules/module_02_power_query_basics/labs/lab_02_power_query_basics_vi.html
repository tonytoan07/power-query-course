<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 2: Power Query Cơ bản - Khóa học Tự động hóa Dữ liệu Excel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292f;
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .header {
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
            color: white;
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .breadcrumb {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .breadcrumb a {
            color: white;
            text-decoration: none;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 600;
        }

        h2 {
            color: #0969da;
            border-bottom: 2px solid #d1d9e0;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }

        h3 {
            color: #24292f;
            margin-top: 1.5rem;
        }

        .lab-info {
            background: #f6f8fa;
            border-left: 4px solid #0969da;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }

        .step-box {
            background: white;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .step-number {
            background: #0969da;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        code {
            background: #f6f8fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.9em;
        }

        pre {
            background: #f6f8fa;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid #d1d9e0;
        }

        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
        }

        .alert-info {
            background: #e6f3ff;
            border: 1px solid #0969da;
            color: #0969da;
        }

        .alert-success {
            background: #e6ffed;
            border: 1px solid #28a745;
            color: #28a745;
        }

        ul,
        ol {
            padding-left: 2rem;
        }

        li {
            margin: 0.5rem 0;
        }

        .lab-image {
            max-width: 700px;
            width: 100%;
            height: auto;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .lab-figure {
            margin: 1.5rem 0;
            text-align: center;
        }

        .image-caption {
            font-size: 0.9rem;
            color: #656d76;
            text-align: center;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .deliverables {
            background: #e6f3ff;
            border: 1px solid #0969da;
            border-radius: 6px;
            padding: 1rem;
            margin: 2rem 0;
        }

        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .lang-btn.active {
            background: rgba(255, 255, 255, 0.9);
            color: #0969da;
            border-color: white;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 3rem 0;
            padding-top: 2rem;
            border-top: 1px solid #d1d9e0;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="language-switcher">
            <a href="lab_02_power_query_basics.html" class="lang-btn">EN</a>
            <a href="lab_02_power_query_basics_vi.html" class="lang-btn active">VI</a>
        </div>
        <div class="container">
            <div class="breadcrumb">
                <a href="../../../index.html">Trang chủ Khóa học</a> >
                Module 2 >
                Lab 2
            </div>
            <h1>Lab 2: Power Query Cơ bản</h1>
            <p>Import và Làm sạch Dữ liệu Ngân hàng</p>
        </div>
    </div>

    <div class="container">
        <div class="lab-info">
            <strong>Tổng quan Lab:</strong> Import và làm sạch bộ dữ liệu giao dịch ngân hàng hoàn chỉnh (12 triệu bản
            ghi) sẽ được sử dụng để xây dựng dashboard cuối cùng.
            <br><strong>Thời gian:</strong> 2 giờ | <strong>Độ khó:</strong> Cơ bản
        </div>

        <h2>Yêu cầu Tiên quyết</h2>
        <ul>
            <li>Excel 365 hoặc Excel 2019 với Power Query được kích hoạt</li>
            <li>Bộ dữ liệu giao dịch lớn trong training-materials/data/raw/transactions/ (500K dòng mỗi file)</li>
            <li>File hệ thống tài khoản và phân cấp</li>
        </ul>

        <h2>Mục tiêu Lab</h2>
        <p>Sau khi hoàn thành lab này, bạn sẽ có thể:</p>
        <ul>
            <li>Import dữ liệu giao dịch ngân hàng quy mô lớn</li>
            <li>Kết hợp nhiều file hàng tháng một cách hiệu quả</li>
            <li>Áp dụng làm sạch dữ liệu cơ bản</li>
            <li>Kết nối giao dịch với thông tin tài khoản</li>
            <li>Áp dụng các chuyển đổi làm sạch cơ bản</li>
            <li>Tạo template query có thể tái sử dụng</li>
            <li>Chuẩn bị dữ liệu cho phân tích ngân hàng</li>
        </ul>

        <h2>Exercise 1: Import Dữ liệu Giao dịch Thô</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Mở Excel và Truy cập Power Query</h3>
            <ol>
                <li>Mở Excel và tạo workbook mới</li>
                <li>Đi đến tab <strong>Data</strong> → <strong>Get Data</strong> → <strong>From File</strong> →
                    <strong>From Folder</strong>
                </li>
                <li>Điều hướng đến thư mục dữ liệu mẫu: <code>training-materials/data/raw/</code></li>
                <li>Chọn thư mục chứa file giao dịch</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 1 - 1.png" alt="Get Data from Folder" class="lab-image">
                <p class="image-caption">Truy cập Power Query qua Data > Get Data > From Folder</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Import File Giao dịch</h3>
            <ol>
                <li>Nhấp <strong>OK</strong> để tải nội dung thư mục</li>
                <li>Lọc để chỉ hiển thị file <code>.csv</code></li>
                <li>Nhấp <strong>Combine</strong> → <strong>Combine & Transform Data</strong></li>
                <li>Chọn <strong>First file as sample</strong> và nhấp <strong>OK</strong></li>
                <li>Đổi tên query thành <strong>Transactions</strong></li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 1 - 2.png" alt="Combine transaction files" class="lab-image">
                <p class="image-caption">Kết hợp và chuyển đổi file CSV giao dịch</p>
            </div>

            <div class="alert alert-success">
                <strong>Kết quả Mong đợi:</strong> Bạn nên thấy xem trước dữ liệu giao dịch kết hợp với các cột:
                Source.Name (tên file), Date, Account_Code, Description, Debit_Amount, Credit_Amount
            </div>

            <h3><span class="step-number">4</span>Cấu hình Cài đặt Background Load</h3>
            <ol>
                <li>Trong Power Query Editor, vào menu <strong>File</strong></li>
                <li>Chọn <strong>Options and Settings</strong> > <strong>Query Options</strong></li>
            </ol>

            <div class="lab-figure">
                <img src="images/Query Setting 1.1.png" alt="Menu Query Options" class="lab-image">
                <p class="image-caption">Truy cập Query Options trong Power Query Editor</p>
            </div>

            <ol start="3">
                <li>Trong hộp thoại Query Options, điều hướng đến cài đặt <strong>Data Load</strong></li>
                <li>Cấu hình cài đặt background load để tối ưu hiệu suất</li>
                <li>Click <strong>OK</strong></li>
            </ol>

            <div class="lab-figure">
                <img src="images/Query Setting 1.2.png" alt="Cài đặt Query Options" class="lab-image">
                <p class="image-caption">Cấu hình cài đặt background load cho hiệu suất tốt hơn</p>
            </div>
        </div>

        <h2>Exercise 2: Làm sạch Dữ liệu Cơ bản</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Loại bỏ Cột Không cần thiết</h3>
            <ol>
                <li>Right-click trên cột <strong>Source.Name</strong></li>
                <li>Chọn <strong>Remove</strong></li>
                <li>Loại bỏ bất kỳ cột nào khác do hệ thống tạo không cần thiết</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 2 - 1.png" alt="Remove columns" class="lab-image">
                <p class="image-caption">Loại bỏ các cột không cần thiết khỏi dữ liệu giao dịch</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Chuẩn hóa Mã Tài khoản</h3>
            <ol>
                <li>Chọn cột <strong>Account_Code</strong></li>
                <li>Đi đến tab <strong>Transform</strong> → <strong>Format</strong> → <strong>Trim</strong></li>
                <li>Right-click cột → <strong>Change Type</strong> → <strong>Text</strong></li>
                <li>Add Custom Column: <code>= Text.PadStart([AccountCode], 6, "0")</code></li>
                <li>Đặt tên cột mới là <strong>Account_Code_Standard</strong></li>
                <li>Loại bỏ cột <strong>AccountCode</strong> gốc</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 2 - 2.1.png" alt="Standardize account codes" class="lab-image">
                <p class="image-caption">Chuẩn hóa định dạng mã tài khoản</p>
            </div>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 2 - 2.2.png" alt="Account code result" class="lab-image">
                <p class="image-caption">Kết quả sau khi chuẩn hóa mã tài khoản</p>
            </div>

            <div class="alert alert-info">
                <strong>Tại sao điều này quan trọng:</strong> Định dạng mã tài khoản nhất quán đảm bảo tính toàn vẹn dữ
                liệu và ánh xạ đúng với hệ thống tài khoản.
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Làm sạch Mô tả Giao dịch</h3>
            <ol>
                <li>Chọn cột <strong>Description</strong></li>
                <li>Áp dụng <strong>Transform</strong> → <strong>Format</strong> → <strong>Trim</strong></li>
                <li>Áp dụng <strong>Transform</strong> → <strong>Format</strong> → <strong>Clean</strong> (loại bỏ ký tự
                    không in được)</li>
                <li>Áp dụng <strong>Transform</strong> → <strong>Format</strong> → <strong>Uppercase</strong></li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 2 - 3.png" alt="Clean descriptions" class="lab-image">
                <p class="image-caption">Làm sạch và định dạng mô tả giao dịch</p>
            </div>
        </div>

        <h2>Exercise 3: Tạo Lookup Hệ thống Tài khoản</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Import Dữ liệu COA</h3>
            <ol>
                <li>Tạo query mới: <strong>Data</strong> → <strong>Get Data</strong> → <strong>From File</strong> →
                    <strong>From Text/CSV</strong>
                </li>
                <li>Chọn <code>chart_of_accounts.csv</code> từ dữ liệu mẫu</li>
                <li>Nhấp <strong>Transform Data</strong></li>
                <li>Đổi tên query thành <strong>Accounts</strong></li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 3 - 1.png" alt="Import COA" class="lab-image">
                <p class="image-caption">Import file CSV hệ thống tài khoản</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Làm sạch Dữ liệu COA</h3>
            <ol>
                <li>Promote first row to headers (nếu cần)</li>
                <li>Đổi tên cột thành:
                    <ul>
                        <li><strong>Account_Code</strong></li>
                        <li><strong>Account_Name</strong></li>
                        <li><strong>Account_Type</strong></li>
                        <li><strong>BCDKT_Category</strong></li>
                    </ul>
                </li>
                <li>Áp dụng <strong>Trim</strong> cho tất cả cột text</li>
                <li>Chuẩn hóa <strong>Account_Code</strong> sử dụng cùng phương pháp padding</li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Merge với Dữ liệu Giao dịch</h3>
            <ol>
                <li>Quay lại query giao dịch</li>
                <li>Chọn <strong>Home</strong> → <strong>Merge Queries</strong></li>
                <li>Chọn <strong>Account_Code_Standard</strong> từ giao dịch</li>
                <li>Chọn <strong>Account_Code</strong> từ bảng COA</li>
                <li>Chọn loại join <strong>Left Outer</strong></li>
                <li>Expand cột COA để thêm Account_Name, Account_Type và BCDKT_Category</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 3 - 3.1.png" alt="Merge queries" class="lab-image">
                <p class="image-caption">Merge giao dịch với hệ thống tài khoản</p>
            </div>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 3 - 3.2.png" alt="Expand columns" class="lab-image">
                <p class="image-caption">Expand cột đã merge để thêm chi tiết tài khoản</p>
            </div>
        </div>

        <h2>Exercise 4: Tải và Xác thực Kết quả</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Tải Dữ liệu vào Excel</h3>
            <ol>
                <li>Chọn query giao dịch</li>
                <li>Nhấp <strong>Home</strong> → <strong>Close & Load</strong> → <strong>Close & Load To</strong></li>
                <li>Chọn <strong>Only Create Connection</strong> và chọn Add this data to the Data Model</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 4 - 1.png" alt="Load to Data Model" class="lab-image">
                <p class="image-caption">Tải dữ liệu chỉ vào Data Model</p>
            </div>
            <div class="alert alert-info">
                <strong>Tại sao Điều này Quan trọng:</strong> Load vào Data Model thay vì worksheet cải thiện hiệu suất
                với bộ dữ liệu lớn và kích hoạt các tính năng phân tích nâng cao.
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Xác thực Kết quả</h3>
            <ol>
                <li>Kiểm tra tổng debit bằng tổng credit</li>
                <li>Xác minh tất cả tài khoản có tên phù hợp</li>
                <li>Xác nhận phạm vi ngày chính xác</li>
                <li>Xem lại bất kỳ vấn đề chất lượng dữ liệu nào</li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Tạo Báo cáo Chất lượng Dữ liệu</h3>
            <ol>
                <li>Tạo pivot table từ dữ liệu giao dịch</li>
                <li>Hiển thị số lượng bản ghi theo <strong>Account_Type</strong></li>
                <li>Hiển thị tổng số tiền theo <strong>BCDKT_Category</strong></li>
                <li>Xác định bất kỳ tài khoản nào không khớp COA</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 4 - 3.1.png" alt="Data quality pivot" class="lab-image">
                <p class="image-caption">Tạo pivot table để xác thực chất lượng dữ liệu</p>
            </div>

            <div class="lab-figure">
                <img src="images/module 2 - excercise 4 - 3.2.png" alt="Quality report result" class="lab-image">
                <p class="image-caption">Báo cáo chất lượng dữ liệu hiển thị phân bố tài khoản</p>
            </div>
        </div>

        <div class="deliverables">
            <h3>Kết quả Lab</h3>

            <h4>✅ Banking_Dashboard_Data.xlsx</h4>
            <ul>
                <li>Workbook chính với dữ liệu giao dịch đã làm sạch</li>
                <li>Query Transactions với hệ thống tài khoản đã merge</li>
                <li>Cột Account_Name, Account_Type và BCDKT_Category đã được thêm</li>
            </ul>

            <h4>✅ Chỉ số Chất lượng Dữ liệu</h4>
            <ul>
                <li>Không có sai lệch cân bằng (tổng Debit = tổng Credit)</li>
                <li>100% chuẩn hóa mã tài khoản (định dạng 4 chữ số)</li>
                <li>Tất cả giao dịch được liên kết với danh mục COA</li>
                <li>Text sạch, đã trim trong tất cả trường mô tả</li>
            </ul>

            <h4>✅ Nền tảng Power Query</h4>
            <ul>
                <li>Template kết nối dữ liệu có thể tái sử dụng</li>
                <li>Thao tác merge cho bảng lookup</li>
                <li>Sẵn sàng cho chuyển đổi nâng cao trong Module 3</li>
            </ul>
        </div>

        <h2>Bước tiếp theo</h2>
        <p>Trong Module 3, bạn sẽ học các kỹ thuật Power Query nâng cao bao gồm:</p>
        <ul>
            <li>Các tình huống merge dữ liệu phức tạp</li>
            <li>Xử lý lỗi và xác thực dữ liệu</li>
            <li>Các hàm chuyển đổi nâng cao</li>
            <li>Xây dựng query mạnh mẽ, có thể mở rộng</li>
        </ul>

        <div class="nav-buttons">
            <a href="../../module_01_overview/labs/lab_01_setup_vi.html" class="btn btn-secondary">← Trước: Module 1</a>
            <a href="../../module_03_power_query_advanced/labs/lab_03_power_query_advanced_vi.html"
                class="btn btn-primary">Tiếp: Module 3 →</a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>

</html>