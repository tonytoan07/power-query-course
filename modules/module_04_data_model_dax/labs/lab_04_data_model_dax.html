<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 4: Simple Table Connections and Calculations - Excel Data Automation Training</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292f;
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .header {
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
            color: white;
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .breadcrumb {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .breadcrumb a {
            color: white;
            text-decoration: none;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 600;
        }

        h2 {
            color: #0969da;
            border-bottom: 2px solid #d1d9e0;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }

        h3 {
            color: #24292f;
            margin-top: 1.5rem;
        }

        .lab-info {
            background: #f6f8fa;
            border-left: 4px solid #0969da;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }

        .step-box {
            background: white;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .step-number {
            background: #0969da;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        code {
            background: #f6f8fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.9em;
        }

        pre {
            background: #f6f8fa;
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
        }

        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
        }

        .alert-info {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            color: #1e40af;
        }

        .alert-warning {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            color: #92400e;
        }

        .alert-success {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            color: #065f46;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 2rem 0;
            padding: 1rem 0;
            border-top: 1px solid #d1d9e0;
        }

        .nav-button {
            background: #0969da;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
        }

        .nav-button:hover {
            background: #0550ae;
        }

        ul,
        ol {
            padding-left: 1.5rem;
        }

        li {
            margin: 0.5rem 0;
        }

        .lab-image {
            max-width: 700px;
            width: 100%;
            height: auto;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .lab-figure {
            margin: 1.5rem 0;
            text-align: center;
        }

        .image-caption {
            font-size: 0.9rem;
            color: #656d76;
            text-align: center;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .deliverables {
            background: #e6f3ff;
            border: 1px solid #0969da;
            border-radius: 6px;
            padding: 1rem;
            margin: 2rem 0;
        }

        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .lang-btn.active {
            background: rgba(255, 255, 255, 0.9);
            color: #0969da;
            border-color: white;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="language-switcher">
            <a href="lab_04_data_model_dax.html" class="lang-btn active">EN</a>
            <a href="lab_04_data_model_dax_vi.html" class="lang-btn">VI</a>
        </div>
        <div class="container">
            <div class="breadcrumb">
                <a href="../../../index.html">Training Home</a> >
                Module 4 >
                Lab 4
            </div>
            <h1>Lab 4: Simple Table Connections and Calculations</h1>
            <p>Building BCDKT Data Model</p>
        </div>
    </div>

    <div class="container">
        <div class="lab-info">
            <h3>Lab Overview</h3>
            <p>In this lab, you will connect your transaction data to account information and use pre-built calculations
                to create the foundation for your dashboard. No complex formulas required - we'll use ready-made
                calculations.</p>

            <h4>Lab Objectives</h4>
            <p>By the end of this lab, you will be able to:</p>
            <ul>
                <li>Connect transaction data to account information</li>
                <li>Use pre-built banking calculations</li>
                <li>Create simple summary tables</li>
                <li>Validate data accuracy</li>
            </ul>
        </div>

        <h2>Exercise 1: Design Data Model Structure</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Analyze Data Requirements</h3>
            <ol>
                <li>Open Excel and review available data tables:
                    <ul>
                        <li><strong>Transactions</strong> (Fact table with merged account info)</li>
                        <li><strong>Time_Periods</strong> (Dimension table)</li>
                        <li><strong>Account_Hierarchy</strong> (Dimension table)</li>
                        <li><strong>Accounts</strong> (Dimension table)</li>
                        <li><strong>Exchange_Rates</strong> (Dimension table)</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Create Data Model Diagram</h3>
            <ol>
                <li>Go to <strong>Data</strong> → <strong>Data Model</strong> (or <strong>Power Pivot</strong>)</li>
                <li>Import all tables using existing Power Query connections</li>
                <li>Review table structures and identify:
                    <ul>
                        <li>Primary keys in each table</li>
                        <li>Foreign key relationships</li>
                        <li>Fact vs dimension table classification</li>
                    </ul>
                </li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 4 - excercise 1 - 2.png" alt="Data Model view" class="lab-image">
                <p class="image-caption">Power Pivot Data Model diagram view</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Establish Table Relationships</h3>
            <ol>
                <li><strong>Transactions to Time_Periods</strong>:
                    <ul>
                        <li>Drag <strong>Date</strong> from Transactions to <strong>Date</strong> in Time_Periods</li>
                        <li>Ensure proper date relationship</li>
                    </ul>
                </li>
                <li><strong>Transactions to Account_Hierarchy</strong>:
                    <ul>
                        <li>Drag <strong>Account_Code_Standard</strong> from Transactions to
                            <strong>Account_Code_Standard</strong> in
                            Account_Hierarchy
                        </li>
                        <li>Verify hierarchy relationship for balance sheet grouping</li>
                    </ul>
                </li>
                <li><strong>Transactions to Accounts</strong>:
                    <ul>
                        <li>Drag <strong>Account_Code_Standard</strong> from Transactions to
                            <strong>Account_Code_Standard</strong> in
                            Accounts
                        </li>
                        <li>Verify hierarchy relationship for balance sheet grouping</li>
                    </ul>
                </li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 4 - excercise 1 - 3.png" alt="Table relationships" class="lab-image">
                <p class="image-caption">Establish relationships between tables</p>
            </div>
        </div>

        <h2>Exercise 2: Create Basic DAX Measures</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Set Up Measure Table</h3>
            <ol>
                <li>In Power Query: <strong>Home → Enter Data</strong></li>
                <li>Create table named <strong>_Measures</strong> with one column "Placeholder" and one row value "1"
                </li>
                <li>Click <strong>OK</strong> to create the table</li>
                <li>Load to Data Model only (uncheck "Load to worksheet")</li>
                <li>Hide this table from client tools in Power Pivot</li>
            </ol>
            <div class="lab-figure">
                <img src="images/module 4 - excercise 2 - 1.png" alt="Create DAX measure" class="lab-image">
                <p class="image-caption">Create _Measures table in Power Query</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Dynamic Currency Conversion Measure</h3>
            <ol>
                <li>Create <strong>Total Amount</strong> measure (root measure for dynamic currency):
                    <pre><code>Total Amount := 
DIVIDE(
    SUM(Transactions[Amount_VND]), 
    MIN(Exchange_Rates[Rate])
)</code></pre>
                </li>
                <li>This measure dynamically converts VND amounts based on Exchange_Rates slicer selection</li>
                <li>Use Currency column from Exchange_Rates table as slicer for currency selection</li>
            </ol>
            <div class="lab-figure">
                <img src="images/module 4 - excercise 2 - 2.png" alt="Aggregation measures" class="lab-image">
                <p class="image-caption">Create Total Amount measures</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Basic Aggregation Measures</h3>
            <ol>
                <li>Create <strong>Total Debit Amount</strong> measure:
                    <pre><code>Total Debit Amount := 
CALCULATE(
    [Total Amount],
    Transactions[TransactionType] = "DEBIT"
)</code></pre>
                </li>
                <li>Create <strong>Total Credit Amount</strong> measure:
                    <pre><code>Total Credit Amount := 
CALCULATE(
    [Total Amount],
    Transactions[TransactionType] = "CREDIT"
)</code></pre>
                </li>
                <li>Create <strong>Net Balance</strong> measure:
                    <pre><code>Net Balance := [Total Debit Amount] + [Total Credit Amount]</code></pre>
                </li>
            </ol>
        </div>

        <h2>Exercise 3: Balance Sheet Measures</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Balance Sheet Category Measures</h3>
            <ol>
                <li><strong>Total Assets</strong> measure:
                    <pre><code>Total Assets := 
CALCULATE(
    [Total Amount],
    Accounts[Account_Type] = "Asset"
)</code></pre>
                </li>
                <li><strong>Total Liabilities</strong> measure:
                    <pre><code>Total Liabilities := 
CALCULATE(
    [Total Amount],
    Accounts[Account_Type] = "Liability"
) * -1</code></pre>
                </li>
                <li><strong>Total Equity</strong> measure:
                    <pre><code>Total Equity := 
CALCULATE(
    [Total Amount],
    Accounts[Account_Type] = "Equity"
) * -1</code></pre>
                </li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Financial Ratios</h3>
            <ol>
                <li><strong>Current Ratio</strong> measure:
                    <pre><code>Current Ratio := 
DIVIDE(
    [Total Assets],
    [Total Liabilities],
    0
)</code></pre>
                </li>
                <li><strong>Balance Sheet Check</strong> measure (should equal zero):
                    <pre><code>Balance Sheet Check := 
[Total Assets] - [Total Liabilities] - [Total Equity]</code></pre>
                </li>
            </ol>
        </div>

        <div class="deliverables">
            <h3>Lab Deliverables</h3>

            <h4>✅ Data Model Relationships</h4>
            <ul>
                <li>Time_Periods → Transactions (Date relationship)</li>
                <li>Accounts → Transactions (Account_Code_Standard relationship)</li>
                <li>Account_Hierarchy → Transactions (Account_Code_Standard relationship)</li>
            </ul>

            <h4>✅ DAX Measures</h4>
            <ul>
                <li>Total Amount: Dynamic currency conversion</li>
                <li>Total Debit Amount, Total Credit Amount, Net Balance</li>
                <li>Total Assets, Total Liabilities, Total Equity</li>
                <li>Current Ratio, Balance Sheet Check</li>
            </ul>
        </div>

        <h2>Next Steps</h2>
        <p>In Module 5, we will use this data model to create interactive pivot tables and build the complete financial
            dashboard.</p>

        <div class="nav-buttons">
            <a href="../../module_03_power_query_advanced/labs/lab_03_power_query_advanced.html" class="nav-button">←
                Previous Lab</a>
            <a href="../../module_05_pivot_tables/labs/lab_05_complete_dashboard.html" class="nav-button">Next Lab →</a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>

</html>