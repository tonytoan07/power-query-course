<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 4: Mô hình Dữ liệu & DAX - Khóa học Tự động hóa Dữ liệu Excel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292f;
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .header {
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
            color: white;
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .breadcrumb {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .breadcrumb a {
            color: white;
            text-decoration: none;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 600;
        }

        h2 {
            color: #0969da;
            border-bottom: 2px solid #d1d9e0;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }

        h3 {
            color: #24292f;
            margin-top: 1.5rem;
        }

        .lab-info {
            background: #f6f8fa;
            border-left: 4px solid #0969da;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }

        .step-box {
            background: white;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .step-number {
            background: #0969da;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        code {
            background: #f6f8fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.9em;
        }

        pre {
            background: #f6f8fa;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid #d1d9e0;
        }

        ul, ol {
            padding-left: 2rem;
        }

        li {
            margin: 0.5rem 0;
        }

        .lab-image {
            max-width: 700px;
            width: 100%;
            height: auto;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .lab-figure {
            margin: 1.5rem 0;
            text-align: center;
        }

        .image-caption {
            font-size: 0.9rem;
            color: #656d76;
            text-align: center;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .deliverables {
            background: #e6f3ff;
            border: 1px solid #0969da;
            border-radius: 6px;
            padding: 1rem;
            margin: 2rem 0;
        }

        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .lang-btn.active {
            background: rgba(255, 255, 255, 0.9);
            color: #0969da;
            border-color: white;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            gap: 1rem;
        }

        .nav-button {
            background: #0969da;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
        }

        .nav-button:hover {
            background: #0550ae;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="language-switcher">
            <a href="lab_04_data_model_dax.html" class="lang-btn">EN</a>
            <a href="lab_04_data_model_dax_vi.html" class="lang-btn active">VI</a>
        </div>
        <div class="container">
            <div class="breadcrumb">
                <a href="../../../index.html">Trang chủ Khóa học</a> >
                Module 4 >
                Lab 4
            </div>
            <h1>Lab 4: Kết nối Bảng Đơn giản và Tính toán</h1>
            <p>Xây dựng Mô hình Dữ liệu BCDKT</p>
        </div>
    </div>

    <div class="container">
        <div class="lab-info">
            <h3>Tổng quan Lab</h3>
            <p>Trong lab này, bạn sẽ kết nối dữ liệu giao dịch với thông tin tài khoản và sử dụng các tính toán được xây dựng sẵn để tạo nền tảng cho dashboard. Không cần công thức phức tạp - chúng ta sẽ sử dụng các tính toán có sẵn.</p>

            <h4>Mục tiêu Lab</h4>
            <p>Sau khi hoàn thành lab này, bạn sẽ có thể:</p>
            <ul>
                <li>Kết nối dữ liệu giao dịch với thông tin tài khoản</li>
                <li>Sử dụng các tính toán ngân hàng được xây dựng sẵn</li>
                <li>Tạo bảng tóm tắt đơn giản</li>
                <li>Xác thực độ chính xác dữ liệu</li>
            </ul>
        </div>

        <h2>Exercise 1: Thiết kế Cấu trúc Mô hình Dữ liệu</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Phân tích Yêu cầu Dữ liệu</h3>
            <ol>
                <li>Mở Excel và xem lại các bảng dữ liệu có sẵn:
                    <ul>
                        <li><strong>Transactions</strong> (Fact table với thông tin tài khoản đã merge)</li>
                        <li><strong>Time_Periods</strong> (Dimension table)</li>
                        <li><strong>Account_Hierarchy</strong> (Dimension table)</li>
                        <li><strong>Accounts</strong> (Dimension table)</li>
                        <li><strong>Exchange_Rates</strong> (Dimension table)</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Tạo Sơ đồ Mô hình Dữ liệu</h3>
            <ol>
                <li>Đi đến <strong>Data</strong> → <strong>Data Model</strong> (hoặc <strong>Power Pivot</strong>)</li>
                <li>Import tất cả bảng sử dụng kết nối Power Query hiện có</li>
                <li>Xem lại cấu trúc bảng và xác định:
                    <ul>
                        <li>Primary key trong mỗi bảng</li>
                        <li>Mối quan hệ Foreign key</li>
                        <li>Phân loại Fact vs dimension table</li>
                    </ul>
                </li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 4 - excercise 1 - 2.png" alt="Data Model view" class="lab-image">
                <p class="image-caption">Chế độ xem sơ đồ Power Pivot Data Model</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Thiết lập Mối quan hệ Bảng</h3>
            <ol>
                <li><strong>Transactions đến Time_Periods</strong>:
                    <ul>
                        <li>Kéo <strong>Date</strong> từ Transactions đến <strong>Date</strong> trong Time_Periods</li>
                        <li>Đảm bảo mối quan hệ ngày phù hợp</li>
                    </ul>
                </li>
                <li><strong>Transactions đến Account_Hierarchy</strong>:
                    <ul>
                        <li>Kéo <strong>Account_Code_Standard</strong> từ Transactions đến <strong>Account_Code_Standard</strong> trong Account_Hierarchy</li>
                        <li>Xác minh mối quan hệ hierarchy cho nhóm balance sheet</li>
                    </ul>
                </li>
                <li><strong>Transactions đến Accounts</strong>:
                    <ul>
                        <li>Kéo <strong>Account_Code_Standard</strong> từ Transactions đến <strong>Account_Code_Standard</strong> trong Accounts</li>
                        <li>Xác minh mối quan hệ hierarchy cho nhóm balance sheet</li>
                    </ul>
                </li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 4 - excercise 1 - 3.png" alt="Table relationships" class="lab-image">
                <p class="image-caption">Thiết lập mối quan hệ giữa các bảng</p>
            </div>
        </div>

        <h2>Exercise 2: Tạo Measure DAX Cơ bản</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Thiết lập Bảng Measure</h3>
            <ol>
                <li>Trong Power Query: <strong>Home → Enter Data</strong></li>
                <li>Tạo bảng có tên <strong>_Measures</strong> với một cột "Placeholder" và một dòng giá trị "1"</li>
                <li>Nhấp <strong>OK</strong> để tạo bảng</li>
                <li>Load chỉ vào Data Model (bỏ chọn "Load to worksheet")</li>
                <li>Ẩn bảng này khỏi client tool trong Power Pivot</li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Measure Chuyển đổi Tiền tệ Động</h3>
            <ol>
                <li>Tạo measure <strong>Total Amount</strong> (measure gốc cho tiền tệ động):
                    <pre><code>Total Amount := 
DIVIDE(
    SUM(Transactions[Amount_VND]), 
    MIN(Exchange_Rates[Rate])
)</code></pre>
                </li>
                <li>Measure này chuyển đổi số tiền VND một cách động dựa trên lựa chọn slicer Exchange_Rates</li>
                <li>Sử dụng cột Currency từ bảng Exchange_Rates làm slicer để chọn tiền tệ</li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 4 - excercise 2 - 1.png" alt="Create DAX measure" class="lab-image">
                <p class="image-caption">Tạo measure Total Amount trong Power Pivot</p>
            </div>
        </div>

        <div class="step-box">
            <h3><span class="step-number">3</span>Measure Tổng hợp Cơ bản</h3>
            <ol>
                <li>Tạo measure <strong>Total Debit Amount</strong>:
                    <pre><code>Total Debit Amount := 
CALCULATE(
    [Total Amount],
    Transactions[TransactionType] = "DEBIT"
)</code></pre>
                </li>
                <li>Tạo measure <strong>Total Credit Amount</strong>:
                    <pre><code>Total Credit Amount := 
CALCULATE(
    [Total Amount],
    Transactions[TransactionType] = "CREDIT"
)</code></pre>
                </li>
                <li>Tạo measure <strong>Net Balance</strong>:
                    <pre><code>Net Balance := [Total Debit Amount] + [Total Credit Amount]</code></pre>
                </li>
            </ol>

            <div class="lab-figure">
                <img src="images/module 4 - excercise 2 - 2.png" alt="Aggregation measures" class="lab-image">
                <p class="image-caption">Tạo measure tổng hợp cho debit, credit và net balance</p>
            </div>
        </div>

        <h2>Exercise 3: Measure Bảng Cân đối Kế toán</h2>

        <div class="step-box">
            <h3><span class="step-number">1</span>Measure Danh mục Bảng Cân đối Kế toán</h3>
            <ol>
                <li>Measure <strong>Total Assets</strong>:
                    <pre><code>Total Assets := 
CALCULATE(
    [Total Amount],
    Accounts[Account_Type] = "Asset"
)</code></pre>
                </li>
                <li>Measure <strong>Total Liabilities</strong>:
                    <pre><code>Total Liabilities := 
CALCULATE(
    [Total Amount],
    Accounts[Account_Type] = "Liability"
) * -1</code></pre>
                </li>
                <li>Measure <strong>Total Equity</strong>:
                    <pre><code>Total Equity := 
CALCULATE(
    [Total Amount],
    Accounts[Account_Type] = "Equity"
) * -1</code></pre>
                </li>
            </ol>
        </div>

        <div class="step-box">
            <h3><span class="step-number">2</span>Tỷ số Tài chính</h3>
            <ol>
                <li>Measure <strong>Current Ratio</strong>:
                    <pre><code>Current Ratio := 
DIVIDE(
    [Total Assets],
    [Total Liabilities],
    0
)</code></pre>
                </li>
                <li>Measure <strong>Balance Sheet Check</strong> (nên bằng không):
                    <pre><code>Balance Sheet Check := 
[Total Assets] - [Total Liabilities] - [Total Equity]</code></pre>
                </li>
            </ol>
        </div>

        <div class="deliverables">
            <h3>Kết quả Lab</h3>

            <h4>✅ Mối quan hệ Mô hình Dữ liệu</h4>
            <ul>
                <li>Time_Periods → Transactions (mối quan hệ Date)</li>
                <li>Accounts → Transactions (mối quan hệ AccountCode)</li>
                <li>Exchange_Rates → Transactions (mối quan hệ Currency)</li>
            </ul>

            <h4>✅ Measure DAX</h4>
            <ul>
                <li>Total Amount: Chuyển đổi tiền tệ động</li>
                <li>Total Debit Amount, Total Credit Amount, Net Balance</li>
                <li>Total Assets, Total Liabilities, Total Equity</li>
                <li>Current Ratio, Balance Sheet Check</li>
            </ul>
        </div>

        <h2>Bước tiếp theo</h2>
        <p>Trong Module 5, chúng ta sẽ sử dụng mô hình dữ liệu này để tạo pivot table tương tác và xây dựng dashboard tài chính hoàn chỉnh.</p>

        <div class="nav-buttons">
            <a href="../../module_03_power_query_advanced/labs/lab_03_power_query_advanced_vi.html" class="nav-button">←
                Lab trước</a>
            <a href="../../module_05_pivot_tables/labs/lab_05_complete_dashboard_vi.html" class="nav-button">Lab tiếp theo →</a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>

</html>
